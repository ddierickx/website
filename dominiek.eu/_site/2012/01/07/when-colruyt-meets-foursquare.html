<!DOCTYPE html>

<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8" />
	
	<!-- Set the viewport width to device width for mobile -->
	<meta name="viewport" content="width=device-width" />
	
	<title>dominiek &raquo; Colruyt meets Foursquare</title>
  
	<!-- Included CSS Files -->
	<link rel="stylesheet" href="/min/min.css">
	<!-- End Combine and Compress These CSS Files -->

	<!--[if lt IE 9]>
		<link rel="stylesheet" href="/min/min-ie.css">
	<![endif]-->

	
	<!-- IE Fix for HTML5 Tags -->
	<!--[if lt IE 9]>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
    
	<!-- Included JS Files -->
	<script src="/min/min.js"></script>
</head>
<body>

	<!-- container -->
	<div class="container">
        <div class="row spacer"></div>
            
		<div class="row">
			<div class="twelve columns">
            	<div id="header">  
                	<a href="/index.html" alt="Home" title="Home">
	    				<img src="/img/header.png" class="stretch" alt="" />
                     </a>
                </div>
			</div>
		</div>
		
        <div class="row spacer"></div>
        
		<div class="row">
			<div class="ten columns">			
				<!-- Grid Example -->
				<div class="row">
					<div class="twelve columns">
						<div class="panel">
							<!-- <h3>Colruyt meets Foursquare</h3> -->
							<div class="post">
  <h4><a href="/2012/01/07/when-colruyt-meets-foursquare.html">
    &raquo; Colruyt meets Foursquare
  </a></h4>
  <div class="spacer"></div>
  <div class="summary">
  Experiment on extracting visit statistics to points-of-interests using the Foursquare API and some Python scripts. Find out the best time & day to visit your local supermarket or other POIs by analyzing crowdsourced data. Results of a three-week data monitoring experiment is presented here as well as the created tools used to gather it.
  </div>
  
  <div class="content">
	<h3 id='introduction'>Introduction</h3>
<img height='240' src='/img/colruyt.png' width='260' />
<p>In this article, I will discuss the setup and results of an experiment I did with gathering data using the API offered by Foursquare. If you never heard of Foursquare, it is a (smartphone) application that allows users to share their whereabouts with the rest of the world, also know as checking-in. I can&#8217;t really say why I would do this myself but apparently plenty of people love the idea and are checking in literally everywhere to conquer badges and street-cred&#8230;</p>

<p>While waiting in line at the local supermarket (<a href='http://www.colruyt.be' target='_blank'>Colruyt</a>) I had the idea of using this publicly available crowd-sourced data to graph supermarket visits in time. I was thinking where I could find the necessary data to make this graph and after digging into the <a href='https://developer.foursquare.com/docs/explore' target='_blank'>Foursquare API</a>, I got an idea on how it could be done.</p>

<h3 id='the_idea'>The idea</h3>

<p>Using the Foursquare API, we can search for venues that match given criteria, such as contain the word &#8220;Colruyt&#8221;. This search is limited to results within a 100 kilometer radius of the required &#8220;ll&#8221; (location) parameter, so in order to gather data for a larger dataset, we would need just a couple of measure points (at least for Belgium). Keeping a list of unique venue ids we would like to monitor could also be an option but that would need too much requests since the script would then have to send a request for each venue, while when using the search function, the number of checkins is also returned within the results.</p>

<p>Based on this idea, I wrote a script that takes as input a set of locations (lat/lon), a time interval n, a query (such as &#8220;Colruyt&#8221;) and an <a href='https://developer.foursquare.com/overview/auth' target='_blank'>OAuth2 token</a> (needed for Foursquare API authentication). Every n seconds, the script will send a search request to the foursquare API and dump the results (venueID, number of checkins) to a file. This file is then after the monitoring is done aggregated and plotted.</p>

<h3 id='tools'>Tools</h3>
<div class='alert-box'>Note: all code can be found in my <a href='https://github.com/ddierickx/scripts/tree/master/foursquarestats' target='_blank'>github repository</a>.</div>
<p>I created two tools to get the statistics:</p>

<ul>
<li><strong>fsquerystats.py</strong> : the generic monitoring script that will poll the Foursquare search results and store the number of checkins.</li>

<li><strong>fsquerystats_export.py</strong> : will aggreggate the results of the other script and create graphs using <a href='http://matplotlib.sourceforge.net/' target='_blank'>mathplotlib</a>.</li>
</ul>

<h3 id='setup'>Setup</h3>

<p>The <strong>fsquerystats</strong> script was run with the following arguments:</p>
<script src='http://snipt.net/embed/c3e5c7dd78716ec5ed888b1e399362a1' type='text/javascript'>
</script><p />
<p>The script ran for <strong>3 weeks</strong> and polled the search results for the term &#8220;Colruyt&#8221; in a large part of Belgium, storing the number of checkins to a file. There were <strong>118 establishment</strong> watched each <strong>15 minutes</strong>, this resulted in <strong>14860724</strong> datapoints.</p>

<h3 id='results__chart'>Results &amp; Chart</h3>

<p>Now it gets interesting, here are some charts.</p>

<p>Here are the visit statistics for each day individually, Sunday not included for obvious reasons.</p>
<a class='lbpopup' href='/img/colruyt/Mondays.png' title='Mondays'><img height='325' src='/img/colruyt/Mondays.png' width='325' /></a><a class='lbpopup' href='/img/colruyt/Tuesdays.png' title='Tuesdays'><img height='325' src='/img/colruyt/Tuesdays.png' width='325' /></a><a class='lbpopup' href='/img/colruyt/Wednesdays.png' title='Wednesdays'><img height='325' src='/img/colruyt/Wednesdays.png' width='325' /></a><a class='lbpopup' href='/img/colruyt/Thursdays.png' title='Thursdays'><img height='325' src='/img/colruyt/Thursdays.png' width='325' /></a><a class='lbpopup' href='/img/colruyt/Fridays.png' title='Fridays'><img height='325' src='/img/colruyt/Fridays.png' width='325' /></a><a class='lbpopup' href='/img/colruyt/Saturdays.png' title='Saturdays'><img height='325' src='/img/colruyt/Saturdays.png' width='325' /></a><p />
<p>Here is a graph with visits per weekday:</p>
<a class='lbpopup' href='/img/colruyt/all.png' title='Bar chart showing checkins per weekday.'><img height='400' src='/img/colruyt/all.png' width='400' /></a>
<p>Here is a combined graph for each day, you can clearly see some trends here.</p>
<a class='lbpopup' href='/img/colruyt/AllInOne.png' title='Combined line chart of checkins per weekday.'><img height='400' src='/img/colruyt/AllInOne.png' width='400' /></a>
<h3 id='conclusions'>Conclusions</h3>

<p>From these charts we can conclude some things:</p>

<ul>
<li>The calmest time to visit should be on Thursday, 09:00.</li>

<li>Saturdays tend to be the most busy day, especially in the morning.</li>

<li>Visitor count seems to decrease in the early afternoon after 13:00 until it rises again at 15:30.</li>

<li>You can clearly see the store is open an extra hour on Friday (purple line).</li>

<li>A lot of people seem to visit between 18:00 and 19:00, after work.</li>
</ul>

<p>These numbers are of course not really representative, since Foursquare is only used by a really small (but sufficient) number of people and its usage is probably restricted to technology enthousiasts, so that excludes most elderly people. The numbers are not that big but I had expected them to be a lot lower than this. We could clearly see some trends here though I only had three weeks of data.</p>

<p>Don&#8217;t hesitate to contact me with any questions or feedback, thanks for reading!</p>
  </div>
  <p>
  </p>
  <span class="published">Published on 07 Jan 2012</span>
  <hr />
</div>

						</div>
					</div>
				</div>
			</div>

			<div class="two columns nomargin">				
				<div class="menu">
					<ul>
						
							
						    
						    
				
						    <li>
						      <a class="link1" href="/index.html">Home</a>
						    </li>
						
							
						    
						    
				
						    <li>
						      <a class="link2" href="/about.html">About</a>
						    </li>
						
							
						    
						    
				
						    <li>
						      <a class="link3" href="/articles.html">Articles</a>
						    </li>
						
							
						    
						    
				
						    <li>
						      <a class="link4" href="/software.html">Software</a>
						    </li>
						
					</ul>
                    
                    <div class="books">
                     <div class="title">&raquo; Reading (<a href="books.html">see all</a>)</div>
                <iframe src="http://rcm.amazon.com/e/cm?lt1=_blank&bc1=FFFFFF&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=dominiekeu-20&o=1&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=0596806752" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
<iframe src="http://rcm.amazon.com/e/cm?lt1=_blank&bc1=FFFFFF&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=dominiekeu-20&o=1&p=8&l=as4&m=amazon&f=ifr&ref=ss_til&asins=0465067107" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>
				<iframe src="http://rcm.amazon.com/e/cm?lt1=_blank&bc1=FFFFFF&IS2=1&bg1=FFFFFF&fc1=000000&lc1=0000FF&t=dominiekeu-20&o=1&p=8&l=as1&m=amazon&f=ifr&ref=tf_til&asins=1934356581" style="width:120px;height:240px;" scrolling="no" marginwidth="0" marginheight="0" frameborder="0"></iframe>

				</div>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="twelve columns footer">
				&copy; 2012 Dominique Dierickx | <a href="/rss.xml">RSS</a> | <a href="/atom.xml">Atom</a> | Made using <a href="http://github.com/mojombo/jekyll" target="_blank">Jekyll</a>, <a href="http://github.com/zurb/foundation" target="_blank">Foundation</a>
			</div>
		</div>
	</div>
	<!-- container -->
	
	<script type="text/javascript">
		$(function() {
			$("a[class='lbpopup']").lightBox(); // Select all links in the page
		});
	</script>
</body>
</html>
